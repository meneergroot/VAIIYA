(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[110],{498:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var a=s(5155),r=s(2115),n=s(2108);let o=r.forwardRef(function(e,t){let{title:s,titleId:a,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}),l=r.forwardRef(function(e,t){let{title:s,titleId:a,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))});function i(e){let{id:t,type:s,initialVotes:i,userVote:c=0}=e,{data:d}=(0,n.useSession)(),[m,u]=(0,r.useState)(i),[h,x]=(0,r.useState)(c),[p,f]=(0,r.useState)(!1),v=async e=>{if(d&&!p){f(!0);try{let a=await fetch("/api/votes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:e,["post"===s?"postId":"commentId"]:t})});if(!a.ok)throw Error("Failed to vote");let r=await a.json();"Vote removed"===r.message?(u(e=>e-h),x(0)):(u(t=>t-h+e),x(e))}catch(e){console.error("Error voting:",e)}finally{f(!1)}}};return(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("button",{onClick:()=>v(1),disabled:!d||p,className:"p-1 rounded hover:bg-gray-100 ".concat(1===h?"text-blue-500":"text-gray-400"),children:(0,a.jsx)(o,{className:"h-6 w-6"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:m}),(0,a.jsx)("button",{onClick:()=>v(-1),disabled:!d||p,className:"p-1 rounded hover:bg-gray-100 ".concat(-1===h?"text-red-500":"text-gray-400"),children:(0,a.jsx)(l,{className:"h-6 w-6"})})]})}function c(e){let{postId:t,initialComments:s}=e,{data:o}=(0,n.useSession)(),[l,c]=(0,r.useState)(s),[d,m]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),x=async e=>{if(e.preventDefault(),!o)return void h("You must be logged in to comment");try{let e=await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:d,postId:t})});if(!e.ok)throw Error("Failed to post comment");let s=await e.json();c(e=>[s,...e]),m(""),h("")}catch(e){h("Failed to post comment")}};return(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Comments"}),o&&(0,a.jsxs)("form",{onSubmit:x,className:"mb-8",children:[(0,a.jsx)("textarea",{value:d,onChange:e=>m(e.target.value),placeholder:"What are your thoughts?",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3}),u&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-2",children:u}),(0,a.jsx)("button",{type:"submit",className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Comment"})]}),(0,a.jsx)("div",{className:"space-y-4",children:l.map(e=>{var t,s;let r=e.votes.reduce((e,t)=>e+t.value,0),n=(null==(t=e.votes[0])?void 0:t.value)||0;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"mr-4",children:(0,a.jsx)(i,{id:e.id,type:"comment",initialVotes:r,userVote:n})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsxs)("span",{children:["u/",null==(s=e.author)?void 0:s.name]}),(0,a.jsx)("span",{className:"mx-1",children:"â€¢"}),(0,a.jsx)("span",{children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsx)("p",{className:"text-gray-700",children:e.content})]})]})},e.id)})})]})}},7891:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6874,23)),Promise.resolve().then(s.bind(s,498))}},e=>{var t=t=>e(e.s=t);e.O(0,[874,108,441,684,358],()=>t(7891)),_N_E=e.O()}]);